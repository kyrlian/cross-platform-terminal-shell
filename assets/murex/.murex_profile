# murex profile

# Aliases

alias ll=ls -al

# Murex aliases on windows
if { os windows } then {
    alias ls=dir
}

# Improve readability of ls
export TIME_STYLE=long-iso
export BLOCK_SIZE="'1"

# Improve readability of grep
alias grep=grep --color=auto
if { os linux } then { alias ls=ls --color=auto }

# Editors

export EDITOR=hx

if { which nvim } then { alias vi=nvim }

# Suggestions

config: set shell max-suggestions 12

# https://github.com/sharkdp/bat
if { which bat } then {
    alias cat=bat
    summary cat ${man-summary cat}
}

function pless {
    # less for JSON
    -> trypipe { -> pretty -> less }
}

function chdir {
    # make a directory then change to that new dir (assumes `-p` flag where supported)
    try {
        switch ${os} {
            case windows { tout json {} }
            case linux   { tout json {[ "-p", "--" ]} }
            catch        { tout json {[ "-p" ]} }
        } -> set flags

        mkdir @flags $ARGS[1]
        cd $ARGS[1]
    }
}

function pwd_short {
    # Normalise path to it's short form
    pwd -> regexp "s#^$HOME#\~#"
}

# Prompt

config: set shell prompt {
    exitnum -> !if {
        out "{RESET}{YELLOW}${pwd_short} {GREEN}»{RESET} "
    } else {
        out "{RESET}{YELLOW}${pwd_short} {RED}»{RESET} "
    }
}

config: set shell prompt-multiline {
    let len = ${pwd_short -> wc -c} - 1
    printf "%${$len}s » " $linenum
}

#config: set shell hint-text-formatting "{ALT-FONT-1}{BLUE}"
